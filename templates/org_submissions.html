{% extends "base.html" %}
{% load static %}
{% load django_vite %}

{% block head %}
    {% vite_asset 'src/components/dq/OrgSubmission.svelte' %}
{% endblock %}

{% block title %}Organisation Submissions{% endblock %}

{% block content %}
<div class="container xl:max-w-screen-xl pt-2 md:pt-6 pb-4">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <h1 class="text-4xl font-bold mb-6 text-gray-900">Organisation Submissions</h1>
        
        <div class="mb-8">
            <p class="text-gray-700 mb-4">This chart visualises the data submission history for organisations within the SCMD. It offers a quick overview of submission patterns, helping to identify gaps and organisational changes over time.</p>
            
            <p class="text-gray-700 mb-4">Each square represents a monthly submission:</p>
            <ul class="list-disc ml-8 mb-4 text-gray-700">
                <li><span class="text-blue-600 font-bold">Blue bars</span> indicate a successful submission, with the height showing the number of unique products submitted that month</li>
                <li><span class="text-red-600 font-bold">Red bars</span> indicate a missing submission</li>
            </ul>

            <p class="text-gray-700 mb-4">Where an organisation has multiple predecessors, the number of unique products submitted is the sum of the unique products submitted by the organisation and its predecessors.</p>

            <p class="text-gray-700 mb-4">The chart shows data from <strong>{{ earliest_date }}</strong> to <strong>{{ latest_date }}</strong>.</p>
            
            <p class="text-gray-700 mb-4">You can sort the organisations in different ways:</p>
            <ul class="list-disc ml-8 mb-4 text-gray-700">
                <li><strong>Submission status in latest month</strong> - Shows organisations missing the most recent submission first.</li>
                <li><strong>Number of months with no data submission</strong> - Shows organisations with the most months with no submissions first.</li>
                <li><strong>Deviation from the median number of products</strong> - Orders by the extent to which the number of unique products an organisation submits each month varies from the median number of unique products submitted for that organisation across all months. Months with no submissions are excluded from this calculation.</li>
                <li><strong>Alphabetically</strong> - Orders organisations by name.</li>
            </ul>

            <p class="text-gray-700 mb-4">The data within the SCMD is initially made available as provisional data, which is subject to change before being finalised. The latest date for finalised data is shown below and organisation submission information beyond this date is shaded to indicate that it is provisional. See <a href="/faq/#data-status" class="underline font-semibold" target="_blank">the FAQs</a> for more details.</p>
        </div>

        <org-submission 
            orgData="{{ org_data_json|escapejs }}"
            latestDates="{{ latest_dates|escapejs }}"
        ></org-submission>
    </div>
</div>

{% endblock %}
